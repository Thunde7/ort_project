<!DOCTYPE html>
<html>
  <head>
    <title>Results</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
    <link rel="stylesheet" href="../static/style.css">
  </head>
  <body>
    <div class="main-block">
    <h1>Select File to show Results for</h1><hr>
    <form method="POST", enctype="multipart/form-data">
    {{ form.csrf_token }}
    <label id="icon" for="name"><i class="fas fa-user"></i></label>
    <input type="text" name="name" id="username" placeholder="Username" required/>
    <label id="icon" for="files"><i class="fas fa-file-archive"></i></label>
    {{ form.files }}
    <div class="btn-block">
      <button type="submit", href="/">Display</button>
    </div>
    <hr>
    <div class="btn-block">
      <button type="redirect", href="/..">Home</button>
    </div>
    <div class="btn-block">
      <button type="redirect", href="/../upload/">Upload a new file</button>
    </div>
    </form>
    <script>
        var username = document.getElementById("username");
        var file_select = document.getElementById("files");

        username.onchange = () => {
            user = username.value;
            
            fetch('/user_files/' + user).then(function(response) {

                response.json().then(function(data) {
                    var optionHTML = '';
                    for (var file of data.files) {
                        optionHTML += '<option value="' + file.id + '">' + file.name + '</option>';
                    }
                    file_select.innerHTML = optionHTML;
                })
            });
        }
    </script>
    </div>
  </body>
</html>